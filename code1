import pyautogui
import time
import win32gui
import win32con

# ğŸ”¹ ì €ì¥í•  ë‹¨í†¡ë°© ì´ë¦„ (ì›í•˜ëŠ” ë‹¨í†¡ë°© ì´ë¦„ìœ¼ë¡œ ë³€ê²½)
TARGET_CHATROOM = "ë‚´ê°€ ì›í•˜ëŠ” ë‹¨í†¡ë°©"

# 1. ì¹´ì¹´ì˜¤í†¡ ë‹¨í†¡ë°© ì°¾ê¸° í•¨ìˆ˜
def find_chatroom_window():
    def callback(hwnd, extra):
        title = win32gui.GetWindowText(hwnd)  # ì°½ ì œëª© ê°€ì ¸ì˜¤ê¸°
        if TARGET_CHATROOM in title:  # íŠ¹ì • ë‹¨í†¡ë°© ì°¾ê¸°
            extra.append(hwnd)

    hwnds = []
    win32gui.EnumWindows(callback, hwnds)
    return hwnds[0] if hwnds else None

# 2. ë‹¨í†¡ë°© ì°½ í™œì„±í™” ë° ëŒ€í™” ì €ì¥ ì‹¤í–‰
def save_chat():
    hwnd = find_chatroom_window()
    if hwnd:
        win32gui.ShowWindow(hwnd, win32con.SW_RESTORE)  # ì°½ì´ ìµœì†Œí™”ë˜ì–´ ìˆìœ¼ë©´ ë³µêµ¬
        win32gui.SetForegroundWindow(hwnd)  # ì°½ì„ ìµœìƒìœ„ë¡œ ì´ë™
        time.sleep(1)  # í™œì„±í™”ë  ì‹œê°„ í™•ë³´

        # 3. Ctrl + S ì…ë ¥ (ëŒ€í™” ë‚´ìš© ì €ì¥)
        pyautogui.hotkey('ctrl', 's')
        time.sleep(1)  # ì €ì¥ì°½ì´ ëœ¨ëŠ” ì‹œê°„ ëŒ€ê¸°

        # 4. íŒŒì¼ ì €ì¥ (ê¸°ë³¸ íŒŒì¼ëª…ìœ¼ë¡œ ì €ì¥)
        pyautogui.press('enter')

        print(f"âœ… '{TARGET_CHATROOM}' ëŒ€í™” ì €ì¥ ì™„ë£Œ!")
    else:
        print(f"âŒ '{TARGET_CHATROOM}' ì°½ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")

# ì‹¤í–‰
if __name__ == "__main__":
    save_chat()
